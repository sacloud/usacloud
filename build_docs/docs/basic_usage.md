# 基本的な使い方

---

## コマンド基本構文

`usacloud`コマンドの基本構文は以下の通りです。

```bash
usacloud [グローバルオプション] <操作対象のリソース> <コマンド> [コマンドオプション] 引数
```

#### 指定できる値

リソースやコマンド、オプションに指定できる値は[help表示](#help)で確認できます。

#### コマンド実行例

```bash
#------------------------------------------------------------------------------
# サーバー(server)に対する一覧表示コマンド(ls)の場合の例
#------------------------------------------------------------------------------

# 基本的な使い方(オプション/引数なし)
usacloud server ls

# グローバルオプションあり
usacloud --zone tk1a server ls

# オプション(短い形式)
usacloud server ls -q

# オプション(長い形式)
usacloud server ls --name foobar

# オプションは=を明示してもOK
usacloud server ls --name=foovar
```

---

## help表示

`-h`または`--help`フラグを指定するとヘルプ表示を行います。   
フラグを指定する位置で表示できる内容が変化します。

#### グローバルオプション/操作対象のリソースのヘルプ表示

```bash
usacloud -h
```

#### コマンドのヘルプ表示

```bash
#
# 書式: usacloud <操作対象のリソース> -h
#

# サーバー(server)のヘルプ表示の例
usacloud server -h
```

#### コマンドオプション/引数のヘルプ表示

```bash
#
# 書式: usacloud <操作対象のリソース> <コマンド> -h
#

# サーバー(server1)の一覧表示コマンド(ls)のヘルプ表示の例
usacloud server ls -h
```

--- 

## グローバルオプション

---

#### コンフィグ(`--config`)

利用するコンフィグ(プロファイル)の指定を行います。(エイリアス:`--profile`)  
指定可能な値は`usacloud config list`コマンドで調べることができます。  

> 通常この値は`~/.usacloud/current`の値が利用されます。  
> 環境変数`USACLOUD_PROFILE`での指定、またはコマンド実行時の`--config`の指定でこの設定を上書き可能です。  

---

#### APIトークン(`--token`)

さくらのクラウドのAPIトークンを指定します。  

> 通常この値は`~/.usacloud/[current-profile-nane]/config.json`の値が利用されます。  
> 環境変数`SAKURACLOUD_ACCESS_TOKEN`での指定、またはコマンド実行時の`--token`の指定でこれらの設定を上書き可能です。  

---

#### APIシークレット(`--secret`)

さくらのクラウドのAPIシークレットを指定します。  

> 通常この値は`~/.usacloud/[current-profile-nane]/config.json`の値が利用されます。  
> 環境変数`SAKURACLOUD_ACCESS_TOKEN_SECRET`での指定、またはコマンド実行時の`--secret`の指定でこれらの設定を上書き可能です。  

---

#### 操作対象ゾーン(`--zone`)

操作対象とするさくらのクラウドのゾーンを指定します。  
指定可能な値は以下のいずれかです。

  * `is1a` : 石狩第1ゾーン
  * `is1b` : 石狩第2ゾーン
  * `tk1a` : 東京第1ゾーン
  * `tk1v` : サンドボックス

> 通常この値は`~/.usacloud/[current-profile-nane]/config.json`の値が利用されます。  
> 環境変数`SAKURACLOUD_ZONE`での指定、またはコマンド実行時の`--zone`の指定でこれらの設定を上書き可能です。  

---

#### デフォルト出力形式(`--default-output-type`)

デフォルトの出力形式を指定します。
指定可能な値は以下のいずれかです。

  * `table` : テーブル形式(デフォルト)
  * `json`  : JSON形式
  * `csv`   : CSV形式
  * `tsv`   : TSV形式

> 通常この値は`~/.usacloud/[current-profile-nane]/config.json`の値が利用されます。  
> 環境変数`USACLOUD_DEFAULT_OUTPUT_TYPE`での指定、またはコマンド実行時の`--output-type`(エイリアス:`--out`)の指定でこの設定を上書き可能です。  

---



#### ヘルプ表示(`--help` or `-h`)

ヘルプ表示を行います。詳細は[help表示](#help)を参照してください。

---

#### バージョン表示(`--version` or `-v`)

usacloudのバージョン情報を表示します。

---

#### トレース出力(`--trace`) * *上級者向け* *

さくらのクラウドAPI呼び出しのトレースログを標準出力へ書き込みます。

---

## 共通オプション: 出力の設定

出力の行われるコマンドでは以下の出力オプションが利用可能です。  
(`bill csv`などの一部コマンドでは出力オプションを利用できない場合があります)  

---

#### 出力タイプ(`--output-type` or `--out`)

出力形式を選択します。指定可能な値は以下のいずれかです。  

  * `table` : テーブル形式
  * `json`  : JSON
  * `csv`   : CSV形式
  * `tsv`   : TSV形式

未指定の場合はグローバルオプション`--default-output-type`の設定が利用されます。

---
 
#### 出力カラム(`--column` or `--col`)

出力する列名を指定します。  
列名は対象オブジェクトのフィールド名をドットで繋いだものを指定します。  
複数の列名を指定したい場合はオプションを複数指定してください。  

**このオプションは`--output-type`が`csv`または`tsv`の場合のみ指定可能です。**

サーバーに対する列名指定の例:

- サーバー名の場合: `Name`
- サーバーの1番目(インデックス0)のNICのIDの場合: `Interfaces.0.ID`

```bash
usacloud server ls --output-type csv --column=ID --column=Interfaces.0.ID
```

---

#### quietモード(`--quiet` or `-q`)

IDのみ出力します。

**このオプションは`--output-type`と一緒に指定できません。 **

---

#### フォーマット(`--format` or `--fmt`)

出力フォーマットをgo言語の[text/template](https://golang.org/pkg/text/template/)形式で指定します。

```bash
usacloud server ls --format "ID is {{.ID}}, Name is {{.Name}}"
```
   
---

## 共通オプション: 対話をスキップ

#### yesオプション(`-y` or `--assumeyes`)

実行時に確認ダイアログが表示されるコマンドで利用可能です。  
確認ダイアログ全てに`y` または `yes`を入力します。  

## 引数: IDまたは名称の指定

特定のリソースに対するコマンドの場合、IDまたは名称を引数にとります。  
名称を指定した場合、部分一致のAND結合(スペース区切り)でヒットしたリソース全てを対象としてコマンドを実行します。

**複数リソースの一括操作に対応していないコマンドの場合、対象が複数となる指定はエラーとなります。**

例:

```bash
#------------------------------------------------------------------------------
# 以下のリソースが存在する場合の例
#------------------------------------------------------------------------------
usacloud server ls
+--------------+---------+-----+--------+---------------+--------+
|      ID      |  NAME   | CPU | MEMORY |   IPADDRESS   | STATUS |
+--------------+---------+-----+--------+---------------+--------+
| 000000000011 | Test1-1 | 1   | 1024MB | 192.0.2.11/24 | up     |
| 000000000021 | Test2-1 | 1   | 1024MB | 192.0.2.21/24 | up     |
| 000000000031 | Test3-1 | 1   | 1024MB | 192.0.2.31/24 | up     |
| 000000000032 | Test3-2 | 1   | 1024MB | 192.0.2.32/24 | up     |
+--------------+---------+-----+--------+---------------+--------+

#------------------------------------------------------------------------------
# 部分一致(例1)
#------------------------------------------------------------------------------
usacloud server boot Test # 名称にTestを含むもの

Target resource IDs => [
	000000000011,
	000000000021,
	000000000031,
	000000000032
]
Are you sure you want to boot?(y/n) [n]:

#------------------------------------------------------------------------------
# 部分一致(例2)
#------------------------------------------------------------------------------
usacloud server boot Test3 # 名称にTest3を含むもの

Target resource IDs => [
	000000000031,
	000000000032
]
Are you sure you want to boot?(y/n) [n]:

#------------------------------------------------------------------------------
# 部分一致(例3) : スペース区切りで複数指定すると部分一致のAND結合
#------------------------------------------------------------------------------
usacloud server boot "1 2" # 名称に1と2を両方含むもの

Target resource IDs => [
	000000000021
]
Are you sure you want to boot?(y/n) [n]:

```
